<!DOCTYPE html>
<html>
<head>
    <title>Database Connection Test</title>
</head>
<body>
    <h1>Database Connection Test</h1>
    <p>This will check which Supabase database the app is actually connecting to.</p>
    
    <button onclick="checkConnection()">Check Database Connection</button>
    
    <div id="result"></div>

    <script>
        async function checkConnection() {
            const result = document.getElementById('result');
            result.innerHTML = '<p>Checking connection...</p>';

            try {
                // Check environment variables
                const envUrl = import.meta.env.VITE_SUPABASE_URL;
                const envKey = import.meta.env.VITE_SUPABASE_ANON_KEY;
                
                let output = '<h3>Environment Variables:</h3>';
                output += `<p><strong>VITE_SUPABASE_URL:</strong> ${envUrl || 'NOT SET'}</p>`;
                output += `<p><strong>VITE_SUPABASE_ANON_KEY:</strong> ${envKey ? 'SET' : 'NOT SET'}</p>`;
                
                // Check hardcoded values
                const hardcodedUrl = 'https://qqcoooscyzhyzmrcvsxi.supabase.co';
                const hardcodedKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFxY29vb3NjeXpoeXptcmN2c3hpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM0MjQ2MTMsImV4cCI6MjA2OTAwMDYxM30.8PIgWiNvwcUVKWyK6dH74eafBMgD-mfhaRZeanCzb6E';
                
                output += '<h3>Hardcoded Values:</h3>';
                output += `<p><strong>URL:</strong> ${hardcodedUrl}</p>`;
                output += `<p><strong>Key:</strong> ${hardcodedKey ? 'SET' : 'NOT SET'}</p>`;
                
                // Determine which URL will be used
                const finalUrl = envUrl || hardcodedUrl;
                output += '<h3>Final Connection URL:</h3>';
                output += `<p><strong>Will connect to:</strong> ${finalUrl}</p>`;
                
                // Test actual connection
                output += '<h3>Testing Connection:</h3>';
                
                const { createClient } = await import('https://esm.sh/@supabase/supabase-js');
                const supabase = createClient(finalUrl, envKey || hardcodedKey);
                
                // Try to query the database
                const { data, error } = await supabase
                    .from('users')
                    .select('count')
                    .limit(1);
                
                if (error) {
                    output += `<p style="color: red;">❌ Connection failed: ${error.message}</p>`;
                } else {
                    output += `<p style="color: green;">✅ Connection successful!</p>`;
                    output += `<p>Database is accessible.</p>`;
                }
                
                result.innerHTML = output;
                
            } catch (error) {
                result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html> 